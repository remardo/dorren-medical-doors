@echo off
echo üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–≤–µ—Ä–µ–π
echo ==============================================

echo.
echo üìã –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
cd
echo –¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: %cd%

echo.
echo üì¶ –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
if not exist "node_modules" (
    echo ‚ùå node_modules –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
    echo üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...
    call npm install
    if errorlevel 1 (
        echo ‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
        pause
        exit /b 1
    )
) else (
    echo ‚úÖ node_modules –Ω–∞–π–¥–µ–Ω–∞
)

echo.
echo üî® –®–∞–≥ 3: –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
echo –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è: npm run build
call npm run build

if errorlevel 1 (
    echo.
    echo ‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
    echo.
    echo üîß –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:
    echo 1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: fix-npm.bat
    echo 2. –£–¥–∞–ª–∏—Ç–µ node_modules –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
    echo 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–∞—Ö src –∏ public
    pause
    exit /b 1
)

echo.
echo ‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!

echo.
echo üìÅ –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å–±–æ—Ä–∫–∏
if exist "dist\index.html" (
    echo ‚úÖ –§–∞–π–ª dist\index.html –Ω–∞–π–¥–µ–Ω
    dir dist /b
) else (
    echo ‚ùå –§–∞–π–ª—ã —Å–±–æ—Ä–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –ø–∞–ø–∫–µ dist
    echo –û–∂–∏–¥–∞–µ–º–∞—è –ø–∞–ø–∫–∞: dist\
    dir *.html 2>nul
)

echo.
echo üéâ –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è!
echo.
echo üöÄ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
echo    deploy-to-vps.bat 89.23.98.187
echo.
echo –ò–ª–∏ –≤ WSL/Git Bash:
echo    ./deploy-to-vps.sh 89.23.98.187

pause